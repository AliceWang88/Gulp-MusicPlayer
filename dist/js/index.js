!function(n,s){function t(){this.dataList=[],this.rotateTimer=null,this.playTime=0,this.dis=0,this.countingTimer=null}t.prototype={init:function(){this.getDom(),this.getData("../mock/data.json")},getDom:function(){this.img=document.querySelector(".pic img"),this.controlBtn=document.querySelectorAll(".control li"),this.close=document.querySelector(".close"),this.curTime=document.querySelector(".curTime"),this.frontBar=document.querySelector(".frontBg"),this.backBar=document.querySelector(".backBg"),this.drag=document.querySelector(".drag"),this.dot=document.querySelector(".dot")},getData:function(t){var i=this;n.ajax({url:t,method:"get",success:function(t){i.dataList=t,i.indexControl=new s.Index(t.length),i.listControl=new s.MusicList(t),i.loadMusic(i.indexControl.index),i.controlMusic()},error:function(t){}})},loadMusic:function(t){s.renderObj.render(this.dataList[t]),s.audio.load(this.dataList[t].audioSrc),this.listControl.changeActive(t),this.reset()},reset:function(){this.playTime=0,this.dis=0,this.curTime.innerHTML="00:00",this.dot.style.left=0,this.frontBar.style.width=0},controlMusic:function(){var r=this;this.controlBtn[1].addEventListener("touchend",function(){var t=r.indexControl.prev();r.loadMusic(t),r.start()}),this.controlBtn[3].addEventListener("touchend",function(){var t=r.indexControl.next();r.loadMusic(t),r.start()}),this.controlBtn[2].addEventListener("touchend",function(){var t;"play"===s.audio.status?r.stop():r.playTime>=r.dataList[r.indexControl.index].duration?(t=new Event("touchend"),r.controlBtn[3].dispatchEvent(t)):r.start()}),this.controlBtn[4].addEventListener("touchend",function(){r.listControl.showList(),r.listControl.changeScroll(r.indexControl.index)}),this.close.addEventListener("touchend",function(){r.listControl.hideList()}),Array.from(r.listControl.wrap.children).forEach(function(t,i){t.addEventListener("touchend",function(){return r.indexControl.index!==i?(r.indexControl.index=i,r.loadMusic(i),void r.start()):void("pause"===s.audio.status?r.start():r.stop())})}),this.controlBtn[0].addEventListener("touchend",function(){"like"===this.className?(r.dataList[r.indexControl.index].isLike=!1,s.renderObj.renderIslike(!1)):(r.dataList[r.indexControl.index].isLike=!0,s.renderObj.renderIslike(!0))}),this.drag.addEventListener("touchend",function(t){var i=r.dot.offsetWidth/2,n=r.backBar.offsetWidth,e=r.curTime.offsetWidth,o=t.changedTouches[0].clientX,t=o-e-i;o<e+i?t=0:e+i+n<o&&(t=n),r.playTime=Math.floor(t/n*r.dataList[r.indexControl.index].duration),r.dis=t,r.setControlBar(r.playTime,t),s.audio.playTo(r.playTime)})},imgRotate:function(t){clearInterval(this.rotateTimer);var i=this;t=t||0,this.rotateTimer=setInterval(function(){t+=.2,i.img.style.transform="rotate("+t+"deg)",i.img.dataset.rotate=t},1e3/60)},stopRotate:function(){clearInterval(this.rotateTimer)},start:function(){s.audio.play(),this.controlBtn[2].className="pause";var t=this.img.dataset.rotate;this.imgRotate(+t),this.startCounting(this.dataList[this.indexControl.index].duration)},stop:function(){s.audio.pause(),this.controlBtn[2].className="",this.stopRotate(),this.stopCounting()},startCounting:function(t){clearInterval(this.countingTimer);var i=this.backBar.offsetWidth/t,n=this;this.countingTimer=setInterval(function(){n.playTime++,n.dis+=i,n.setControlBar(n.playTime,n.dis),n.playTime>=t&&(n.loadMusic(n.indexControl.next()),n.start())},1e3)},setControlBar:function(t,i){var n=Math.floor(t/60),t=t-60*n;this.curTime.innerHTML=n.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0"),this.frontBar.style.width=i+"px",this.dot.style.left=i+"px"},stopCounting:function(){clearInterval(this.countingTimer)}},(new t).init()}(window.Zepto,window.player);